# 네트워크 모드

> Tanstack Query는 네트워크 연결 상태에 따라 Query, Mutation이 어떻게 동작할지 제어할 수 있는 3가지 `networkMode` 설정을 제공한다.

<br/>

## (1) `online`(기본값)

- **온라인일 때만 요청 실행**
- Query가 실행 중일 때 네트워크가 끊기면 상태는 그대로 유지됨
- `fetchStatus`를 활용해 네트워크 요청 실행 상태 확인 가능
  - `fetching` : 실제 요청을 보내는 중
  - `paused` : 네트워크 연결이 끊겨 멈춘 상태 (⚠️`pending` 이면서 `fetchStatus: paused` 일 수 있음)
  - `idle`: 아무것도 하지 않는 상태
- 네트워크가 끊긴 상태에서 요청이 재시도 중이면 재시도는 일시 중지(`paused`)되며, 연결이 복구되면 자동으로 재개됨(`refetchOnReconnet` 옵션 설정과 별개로 작동)

<br/>

## (2) `always`

- **항상 요청 실행**
- 네트워크 연결 상태와 관계없이 무조건 Query 실행
- 다음과 같은 경우에 적합
  - `queryFn`에서 네트워크 요청 없이 `Promise.resolve()`만 반환하는 경우
  - `AsyncStorage`나 캐시에서 데이터만 읽어오는 경우
- 요청 실패하면 바로 `error` 상태로 진입

<br/>

## (3) `offlineFirst`

- **오프라인 우선 방식**
- 첫 번째 요청은 시도하지만, 실패하면 재시도는 오프라인 상태에서 멈춤
- 다음과 같은 경우에 적합
  - PWA처럼 서비스 워커나 브라우저의 HTTP 캐시를 사용하는 경우
  - 캐시 히트 시에는 성공하지만, 캐시 미스 시에는 실패 → 이 때 재시도는 일시 중지됨
  - ⇒ 최대한 캐시로 처리하고 네트워크 요청은 온라인일 때만 하고싶은 경우
